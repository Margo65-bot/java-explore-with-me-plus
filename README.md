## PUBLIC: КОММЕНТАРИИ

### GET "/events/comments"
Получение комментариев с возможностью сортировки по дате.

**Параметры:**
- `sort` - сортировка по дате. Значения: `ASC`, `DESC`. По умолчанию: `ASC`

**Ответ:**
- Если комментарии не найдены, возвращает пустой список

---

### GET "/events/{eventId}/comments"
Получение комментариев к определённому событию.

**Параметры:**
- `sort` - сортировка по дате. Значения: `ASC`, `DESC`. По умолчанию: `ASC`

**Ответ:**
- Если комментарии не найдены, возвращает пустой список

## PRIVATE: КОММЕНТАРИИ

### GET "/users/{userId}/comments"
Получение комментариев добавленных текущим пользователем.

**Ответ:**
- Если комментарии не найдены, возвращает пустой список

---

### POST "/users/{userId}/comments"
Добавление нового комментария к событию.

**Особенности:**
- Статус `WAITING` по умолчанию

---

### PATCH "/users/{userId}/comments"
Изменение комментария пользователем, который его оставил.

**Ошибки:**
- `400` - Если поле `text` в запросе не указано (равно null), пустое или состоит только из пробелов
- `403` - Пользователь меняющий комментарий не является автором комментария
- `404` - Комментарий не найден или недоступен

**Особенности:**
- Статус `WAITING` по умолчанию

---

### DELETE "/users/{userId}/comments/{comId}"
Удаление комментария пользователем, который его оставил.

**Ошибки:**
- `404` - Комментарий не найден или недоступен

## ADMIN: КОММЕНТАРИИ

### GET "/admin/comments"
Получение комментариев с возможностью поиска по тексту и сортировки по дате.

**Ответ:**
- Если комментарии не найдены, возвращает пустой список

---

### DELETE "/admin/comments/{comId}"
Удаление любого комментария.

**Ошибки:**
- `404` - Комментарий не найден или недоступен

---

### PATCH "admin/comments/{comId}?approved=true/false"
Модерация комментария, его подтверждение/отклонение.

**Ошибки:**
- `404` - Комментарий не найден или недоступен
- `400` - Комментарий не в статусе `WAITING`

## БАЗА ДАННЫХ

```sql
CREATE TABLE IF NOT EXISTS comments (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
  author_id BIGINT NOT NULL REFERENCES users (id) ON DELETE CASCADE, 
  event_id BIGINT NOT NULL REFERENCES events (id) ON DELETE CASCADE, 
  text VARCHAR(1000) NOT NULL,
  state VARCHAR(15) NOT NULL, 
  created_on TIMESTAMP WITHOUT TIME ZONE NOT NULL
);

```
## SCHEMAS:

### Создание комментария
```java
NewCommentDto
{
event        id события
text*        maxLength: 1000, minLength: 1
}
```
### Обновление комментария
```java
UpdateCommentDto
{
id           id комментария
text         maxLength: 1000, minLength: 1
}
```
### Вывод комментария
```java
CommentDto
{
id           id комментария
author       имя автора
text
}
```
### Вывод комментария для администратора
```java
AdminCommentDto
{
id
author
text
state
}
```
### Описание состояний комментария
```java
enum CommentState
{
WAITING,
APPROVED,
REJECTED,
}
```

## MODEL:

```java
@Entity
@Table(name = "comments")
@Getter
@Setter
@ToString
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class Comment {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private long id;
    @ManyToOne
    @JoinColumn(name = "author_id")
    @ToString.Exclude
    private User author;
    @ManyToOne
    @JoinColumn(name = "event_id")
    @ToString.Exclude
    private Event event;
    @Column(nullable = false)
    private String text;
    @Column(name = "state", nullable = false)
    private CommentState state;
    @Column(name = "created_on")
    private LocalDateTime created;
}
```
